System.register("chunks:///_virtual/AnimationHelper.ts",["cc"],(function(n){var t,i,e;return{setters:[function(n){t=n.cclegacy,i=n.tween,e=n.Vec3}],execute:function(){t._RF.push({},"7fd94QMbitFiKzuOwpapSA4","AnimationHelper",void 0);n("AnimationHelper",function(){function n(){}return n.animateNodes=function(n,t,o){var a,l=t.filter((function(n){var t=n.node;return t&&t.isValid}));if(0!==l.length){var r=l.map((function(n){var t=n.node,o=n.x;return i(t).to(.3,{position:new e(o,t.position.y,0)})}));(a=i(n)).parallel.apply(a,r).call(null!=o?o:function(){}).start()}else null==o||o()},n.animateNodePosition=function(n,t,o,a,l){if(n&&n.isValid){var r=i(n).to(a,{position:new e(t,o,0)});l&&r.call(l),r.start()}else null==l||l()},n.animateStickDrop=function(n,t){n&&n.isValid?i(n).to(.25,{angle:-90}).call((function(){return t(n)})).start():t(n)},n.animatePlayerFall=function(n,t){n&&n.isValid?i(n).to(.5,{position:new e(n.position.x,n.position.y-500,0)}).call(t).start():t()},n}());t._RF.pop()}}}));

System.register("chunks:///_virtual/GameManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameModel.ts","./GameView.ts","./AnimationHelper.ts"],(function(t){var e,i,n,o,s,r,a,l,h,u,c,d,m,g,v;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){s=t.cclegacy,r=t._decorator,a=t.Prefab,l=t.Node,h=t.input,u=t.Input,c=t.UITransform,d=t.Component},function(t){m=t.GameModel},function(t){g=t.GameView},function(t){v=t.AnimationHelper}],execute:function(){var w,p,S,f,y,N,P,C,k,b,G,T,x,X,R;s._RF.push({},"c33d8lcuHFLs52KtUu2ySYT","GameManager",void 0);var W=r.ccclass,H=r.property;t("GameManager",(w=W("GameManager"),p=H(a),S=H(a),f=H(a),y=H(l),N=H(g),P=H({type:Boolean}),w((b=e((k=function(t){function e(){for(var e,i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];return e=t.call.apply(t,[this].concat(s))||this,n(e,"playerPrefab",b,o(e)),n(e,"stickPrefab",G,o(e)),n(e,"columnPrefab",T,o(e)),n(e,"startScreen",x,o(e)),n(e,"gameView",X,o(e)),e.model=new m,e.view=null,e.isPlaying=!1,e.currentScaleY=0,n(e,"isRetry",R,o(e)),e.isTransitioning=!1,e}i(e,t);var s=e.prototype;return s.start=function(){h.on(u.EventType.TOUCH_START,this.onTouchStart,this),h.on(u.EventType.TOUCH_END,this.onTouchEnd,this),this.isRetry=!1,this.model.reset()},s.resetGame=function(){this.isPlaying=!1,this.model.reset(),this.view.resetScene();var t=this.calculateInitialPositions(),e=t.startColumnX,i=t.playerX;this.model.setStartColumnX(e),this.model.setPlayerX(i),this.isRetry&&(this.view.setupNextColumn(e),this.model.setNextColumnX(this.view.randomPosition),this.view.getStartColumnNode().setPosition(e,this.view.getStartColumnNode().position.y,0),this.view.getNextColumnNode().setPosition(this.view.randomPosition,this.view.getNextColumnNode().position.y,0),this.view.updatePlayer(i,!0)),this.view.showStartScreen()},s.onStartButton=function(){if(!this.view){if(!this.gameView)throw new Error("gameView is not assigned!");this.view=this.gameView}this.isPlaying=!0,this.view.showPlayScreen();var t=this.calculateInitialPositions(),e=t.startColumnX,i=t.playerX;if(!this.isRetry){this.view.setupNextColumn(e);var n=this.view.randomPosition;this.model.setStartColumnX(e),this.model.setPlayerX(i),this.model.setNextColumnX(n),this.view.getStartColumnNode()&&this.view.getPlayerNode()&&this.view.getNextColumnNode()?this.view.animateInitialSetup(e,i,n):console.error("Cannot animate initial setup: one of the nodes is null")}this.view.updateScoreDisplay(this.model.getScore())},s.onRetryButtonPressed=function(){this.isRetry=!0,this.resetGame(),this.onStartButton()},s.calculateInitialPositions=function(){var t=-this.view.getCanvasWidth()/2+this.getNodeWidth(this.view.getStartColumnNode())/2;return{startColumnX:t,playerX:t+this.getNodeWidth(this.view.getPlayerNode())/4}},s.onTouchStart=function(){if(this.isPlaying&&!this.model.isStickGrowing()&&!this.isTransitioning){var t=this.view.getStartColumnNode();this.model.setStickGrowing(!0),this.currentScaleY=.1;var e=this.model.getStartColumnX()+this.getNodeWidth(t)/2,i=t.position.y+this.getNodeHeight(t)/2;this.view.createStick(e,i)}},s.onTouchEnd=function(){var t=this;this.isPlaying&&this.model.isStickGrowing()&&(this.model.setStickGrowing(!1),this.view.dropStick(!1,(function(e){return t.checkResult(e)})))},s.checkResult=function(t){var e=this;try{var i=this.view.getStartColumnNode(),n=this.view.getNextColumnNode(),o=this.view.getPlayerNode(),s=i.position.x+this.getNodeWidth(i)/2+this.getNodeHeight(t)*t.scale.y;this.view.animatePlayerToStickEnd(s,(function(){e.checkStickLanding(s,n)?e.handleSuccess(o,n):e.handleFailure(o)}))}catch(t){console.error("Ошибка в checkResult:",t),this.isPlaying=!1,this.view.showGameOverScreen(this.model.getScore())}},s.checkStickLanding=function(t,e){var i=e.position.x-this.getNodeWidth(e)/2,n=e.position.x+this.getNodeWidth(e)/2;return t>=i&&t<=n},s.handleSuccess=function(t,e){var i,n=this,o=e.position.x+this.getNodeWidth(t)/4;this.view.updatePlayer(o,!1);var s=-this.view.getCanvasWidth()/2+this.getNodeWidth(e)/2,r=o-(e.position.x-s);this.isTransitioning=!0,null==(i=this.view.stickNode)||i.destroy(),this.view.stickNode=null,this.view.getStartColumnNode().removeFromParent(),this.view.getStartColumnNode().destroy(),this.view.updateColumnReferences(e,null),this.view.setupNextColumn(s);var a=this.view.randomPosition;this.model.setNextColumnX(a),this.view.animateSceneShift(0,s,r,a,(function(){n.model.setStartColumnX(s),n.model.setPlayerX(r),n.model.incrementScore(),n.view.updateScoreDisplay(n.model.getScore()),n.isTransitioning=!1}))},s.handleFailure=function(t){var e=this;v.animatePlayerFall(t,(function(){e.isPlaying=!1,e.view.showGameOverScreen(e.model.getScore())}))},s.update=function(t){var e,i=this;if(this.isPlaying&&this.model.isStickGrowing()&&null!=(e=this.view)&&e.stickNode){var n=this.view.stickNode,o=1e3/this.getNodeHeight(n),s=this.view.getGrowthSpeed();this.currentScaleY+=s*t,this.currentScaleY>=o&&(this.currentScaleY=o,this.model.setStickGrowing(!1),this.view.dropStick(!1,(function(t){return i.checkResult(t)}))),this.view.updateStick(this.currentScaleY,this.model.getStickAngle())}},s.getNodeWidth=function(t){return t.getComponent(c).width},s.getNodeHeight=function(t){return t.getComponent(c).height},e}(d)).prototype,"playerPrefab",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=e(k.prototype,"stickPrefab",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=e(k.prototype,"columnPrefab",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=e(k.prototype,"startScreen",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=e(k.prototype,"gameView",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=e(k.prototype,"isRetry",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),C=k))||C));s._RF.pop()}}}));

System.register("chunks:///_virtual/GameModel.ts",["cc"],(function(t){var n;return{setters:[function(t){n=t.cclegacy}],execute:function(){n._RF.push({},"19b20HtqkZGCrNz61M11HPM","GameModel",void 0);t("GameModel",function(){function t(){this.playerX=0,this.stickGrowing=!1,this.stickAngle=0,this.startColumnX=0,this.nextColumnX=0,this.score=0}var n=t.prototype;return n.getPlayerX=function(){return this.playerX},n.setPlayerX=function(t){this.playerX=t},n.isStickGrowing=function(){return this.stickGrowing},n.setStickGrowing=function(t){this.stickGrowing=t},n.getStickAngle=function(){return this.stickAngle},n.setStickAngle=function(t){this.stickAngle=t},n.getStartColumnX=function(){return this.startColumnX},n.setStartColumnX=function(t){this.startColumnX=t},n.getNextColumnX=function(){return this.nextColumnX},n.setNextColumnX=function(t){this.nextColumnX=t},n.getScore=function(){return this.score},n.incrementScore=function(){this.score+=1},n.reset=function(){this.playerX=0,this.stickGrowing=!1,this.stickAngle=0,this.startColumnX=0,this.nextColumnX=0,this.score=0},t}());n._RF.pop()}}}));

System.register("chunks:///_virtual/GameView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./PositionCalculator.ts","./AnimationHelper.ts"],(function(e){var t,i,n,o,r,a,s,l,c,u,h,d,p,m,N,f;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){r=e.cclegacy,a=e._decorator,s=e.Node,l=e.Prefab,c=e.Label,u=e.instantiate,h=e.UITransform,d=e.Vec3,p=e.director,m=e.Component},function(e){N=e.PositionCalculator},function(e){f=e.AnimationHelper}],execute:function(){var g,b,S,y,C,v,w,P,x,k,L,W,H,z,I,G,V,O,R,D,T;r._RF.push({},"61a25aTSjRKC7IUyR4joUd6","GameView",void 0);var _=a.ccclass,j=a.property;e("GameView",(g=_("GameView"),b=j(s),S=j(s),y=j(s),C=j(l),v=j(l),w=j(l),P=j({type:Number,tooltip:"(units per second)"}),x=j(c),k=j(c),g((H=t((W=function(e){function t(){for(var t,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,n(t,"startScreen",H,o(t)),n(t,"playScreen",z,o(t)),n(t,"gameOverScreen",I,o(t)),n(t,"playerPrefab",G,o(t)),n(t,"stickPrefab",V,o(t)),n(t,"columnPrefab",O,o(t)),n(t,"growthSpeed",R,o(t)),n(t,"scoreLabel",D,o(t)),n(t,"currentScoreLabel",T,o(t)),t.playerNode=null,t.stickNode=null,t.startColumnNode=null,t.nextColumnNode=null,t.canvasWidth=0,t.columnHeight=0,t.prefabColumnWidth=0,t.randomPosition=0,t}i(t,e);var r=t.prototype;return r.start=function(){this.setScreenIndices(),this.prefabColumnWidth=this.getNodeWidth(u(this.columnPrefab)),this.setupScene(),this.showStartScreen(),this.logNullLabels()},r.setScreenIndices=function(){this.startScreen.setSiblingIndex(10),this.playScreen.setSiblingIndex(11),this.gameOverScreen.setSiblingIndex(12)},r.logNullLabels=function(){this.currentScoreLabel||console.error("GameView: currentScoreLabel is not assigned!"),this.scoreLabel||console.error("GameView: scoreLabel is not assigned!")},r.resetScene=function(){[this.startColumnNode,this.nextColumnNode,this.playerNode,this.stickNode].forEach((function(e){return null==e?void 0:e.destroy()})),this.startColumnNode=this.nextColumnNode=this.playerNode=this.stickNode=null,this.setupScene()},r.setupScene=function(){var e=this.getCanvas();this.canvasWidth=this.getNodeWidth(e);var t=-this.getNodeHeight(e)/2;this.startColumnNode=this.createNode(this.columnPrefab,e,2),this.columnHeight=this.getNodeHeight(this.startColumnNode),this.startColumnNode.setPosition(0,t+this.columnHeight/2,0),this.playerNode=this.createNode(this.playerPrefab,e,4);var i=this.getNodeHeight(this.playerNode);this.playerNode.setPosition(0,t+this.columnHeight+i/2,0)},r.setupNextColumn=function(e){var t,i=this.getCanvas();null==(t=this.nextColumnNode)||t.destroy(),this.nextColumnNode=this.createNode(this.columnPrefab,i,2);var n=N.generateRandomWidth(this.prefabColumnWidth);this.nextColumnNode.getComponent(h).width=n;var o=(null!=e?e:this.startColumnNode.position.x)+this.getNodeWidth(this.startColumnNode)/2,r=-this.getNodeHeight(i)/2;this.randomPosition=N.calculateNextColumnPosition(o,2*this.prefabColumnWidth,n,this.canvasWidth);var a=this.canvasWidth/2+n/2+this.randomPosition;this.nextColumnNode.setPosition(a,r+this.columnHeight/2,0)},r.animateInitialSetup=function(e,t,i){f.animateNodes(this.node,[{node:this.startColumnNode,x:e},{node:this.playerNode,x:t},{node:this.nextColumnNode,x:i}])},r.animateSceneShift=function(e,t,i,n,o){f.animateNodes(this.node,[{node:this.startColumnNode,x:t},{node:this.nextColumnNode,x:n},{node:this.playerNode,x:i}],o)},r.updatePlayer=function(e,t){void 0===t&&(t=!1),this.playerNode&&(t?this.playerNode.setPosition(e,this.playerNode.position.y,0):f.animateNodePosition(this.playerNode,e,this.playerNode.position.y,.3))},r.createStick=function(e,t){var i;null==(i=this.stickNode)||i.destroy(),this.stickNode=this.createNode(this.stickPrefab,this.getCanvas(),5),this.stickNode.setPosition(e,t,0),this.stickNode.getComponent(h).anchorY=0,this.stickNode.setScale(new d(1,.1,1)),this.stickNode.angle=0,console.log("Stick created at position: ("+e+", "+t+")"),console.log("Canvas size: ("+this.canvasWidth+", "+this.getNodeHeight(this.getCanvas())+")")},r.updateStick=function(e,t){this.stickNode&&(this.stickNode.setScale(new d(1,e,1)),this.stickNode.angle=t)},r.dropStick=function(e,t){if(this.stickNode){var i=this.stickNode;e?(i.angle=-90,t(i)):f.animateStickDrop(i,t)}},r.animatePlayerToStickEnd=function(e,t){this.playerNode&&f.animateNodePosition(this.playerNode,e,this.playerNode.position.y,.5,t)},r.updateColumnReferences=function(e,t){this.startColumnNode=e,this.nextColumnNode=t},r.showStartScreen=function(){this.switchScreen("start"),this.updateScoreLabel(this.currentScoreLabel,0,"start screen")},r.showPlayScreen=function(){this.switchScreen("play"),this.updateScoreLabel(this.currentScoreLabel,0,"play screen")},r.showGameOverScreen=function(e){this.switchScreen("gameOver"),this.updateScoreLabel(this.scoreLabel,e,"game over screen","Score: ")},r.switchScreen=function(e){this.startScreen.active="start"===e,this.playScreen.active="play"===e,this.gameOverScreen.active="gameOver"===e},r.updateScoreLabel=function(e,t,i,n){void 0===n&&(n=""),e?e.string=""+n+t.toString():console.warn("GameView: "+i+" label is null")},r.updateScoreDisplay=function(e){this.updateScoreLabel(this.currentScoreLabel,e,"current score display")},r.getGrowthSpeed=function(){return this.growthSpeed},r.getStartColumnNode=function(){return this.startColumnNode},r.getNextColumnNode=function(){return this.nextColumnNode},r.getPlayerNode=function(){return this.playerNode},r.getCanvasWidth=function(){return this.canvasWidth},r.getCanvas=function(){return p.getScene().getChildByName("Canvas")},r.getNodeWidth=function(e){return e.getComponent(h).width},r.getNodeHeight=function(e){return e.getComponent(h).height},r.createNode=function(e,t,i){var n=u(e);return n.setParent(t),n.setSiblingIndex(i),n},t}(m)).prototype,"startScreen",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=t(W.prototype,"playScreen",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=t(W.prototype,"gameOverScreen",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=t(W.prototype,"playerPrefab",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=t(W.prototype,"stickPrefab",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=t(W.prototype,"columnPrefab",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=t(W.prototype,"growthSpeed",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2.5}}),D=t(W.prototype,"scoreLabel",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=t(W.prototype,"currentScoreLabel",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=W))||L));r._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./AnimationHelper.ts","./GameManager.ts","./GameModel.ts","./GameView.ts","./PositionCalculator.ts"],(function(){return{setters:[null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/PositionCalculator.ts",["cc"],(function(t){var n;return{setters:[function(t){n=t.cclegacy}],execute:function(){n._RF.push({},"236ce2K/ERLEp/BkAeZXUNb","PositionCalculator",void 0);t("PositionCalculator",function(){function t(){}return t.generateRandomWidth=function(t){var n=t/3,o=2*t;return Math.random()*(o-n)+n},t.calculateNextColumnPosition=function(t,n,o,a){var r=t+n+o/2,c=a/2-o/2;return Math.max(r,Math.random()*(c-r)+r)},t}());n._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});